<h1>IDカード自動発行システム</h1>

<div class="form-container">
    <label for="username">ユーザーネーム:</label>
    <input type="text" id="username" placeholder="例: 山田太郎" required>

    <label for="rank">階級:</label>
    <input type="text" id="rank" placeholder="例: 係長" required>

    <label for="department">所属:</label>
    <input type="text" id="department" placeholder="例: 営業部" required>

    <label for="company">所属先:</label>
    <input type="text" id="company" placeholder="例: ABC株式会社" required>

    <label for="date">配属年月日:</label>
    <input type="date" id="date" required>

    <button onclick="generateIDCard()">発行</button>
</div>

<!-- プレビュー表示用 -->
<canvas id="idCardCanvas" width="600" height="350"></canvas>

<script>
    // 事前に用意されたテンプレート画像を読み込む
    const templateImage = new Image();
    templateImage.src = 'idcard-template.png'; // 画像ファイルのパスを指定

    templateImage.onload = function() {
        // 画像が読み込まれたら初期化
        const canvas = document.getElementById('idCardCanvas');
        const ctx = canvas.getContext('2d');
        ctx.drawImage(templateImage, 0, 0, canvas.width, canvas.height);
    };

    // IDカード生成
    function generateIDCard() {
        const username = document.getElementById('username').value;
        const rank = document.getElementById('rank').value;
        const department = document.getElementById('department').value;
        const company = document.getElementById('company').value;
        const date = document.getElementById('date').value;

        const canvas = document.getElementById('idCardCanvas');
        const ctx = canvas.getContext('2d');

        if (!templateImage.complete) {
            alert("テンプレート画像が読み込まれていません。");
            return;
        }

        // テンプレート画像をキャンバスに描画
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(templateImage, 0, 0, canvas.width, canvas.height);

        // テキスト設定
        ctx.font = '20px Arial';
        ctx.fillStyle = '#333';

        // ユーザーネームの位置
        ctx.fillText('ユーザーネーム: ' + username, 20, 50);

        // 階級の位置
        ctx.fillText('階級: ' + rank, 20, 90);

        // 所属の位置
        ctx.fillText('所属: ' + department, 20, 130);

        // 所属先の位置
        ctx.fillText('所属先: ' + company, 20, 170);

        // 配属年月日の位置
        ctx.fillText('配属年月日: ' + date, 20, 210);

        // ダウンロードリンク生成
        const dataUrl = canvas.toDataURL('image/png');
        const a = document.createElement('a');
        a.href = dataUrl;
        a.download = username + '_IDCard.png';
        a.textContent = 'IDカードをダウンロード';
        document.body.appendChild(a);
    }
</script>
